(this["webpackJsonpmigration-dashboard"]=this["webpackJsonpmigration-dashboard"]||[]).push([[0],{28:function(e,t,a){e.exports=a(38)},38:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(8),s=a.n(r),o=a(10),l=a(23),c=a(5),d=a.n(c),u=a(1),m=a(13),h=a(18),p=a(19),b=a(4),f=a(25),v=a(24),g=a(2),y=a(3),j=a(39),E=a(40);var O=function(e){var t=e.name,a=e.nodeId,n=e.updateItem,r=e.drupalId,s=e.listId;return i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("a",{href:"/node/".concat(a)},t)),i.a.createElement("td",null,"todo"===s?i.a.createElement("button",{type:"button",onClick:function(){n(r,s,"inProgress","In Progress")}},"Add to In Progress"):i.a.createElement("span",null,"\xa0")))};function x(){var e=Object(g.a)(["\n  margin-top: 3em;\n  //When element enters dom */\n  .fade-enter {\n    opacity: 0;\n  }\n  /* After element enters [transition time] */\n  .fade-enter-active {\n    opacity: 1;\n    transition: opacity 500ms ease-in;\n  }\n  /* When state turns false */\n  .fade-exit {\n    opacity: 1;\n  }\n  /* Right after exit [transition time] */\n  .fade-exit-active {\n    opacity: 0;\n    transition: opacity 500ms ease-in;\n  }\n"]);return x=function(){return e},e}var I=y.a.div(x());function k(e){var t=e.title,a=e.listId,n=e.bios,r=e.updateItem;return i.a.createElement(I,null,i.a.createElement("h2",null,t," ",i.a.createElement("span",null,n.length?"(".concat(n.length," item").concat(n.length>1?"s":"",")"):null)),i.a.createElement("table",{className:"views-table views-view-table cols-7 responsive-enabled sticky-enabled sticky-table"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Name"),i.a.createElement("th",null," "))),i.a.createElement("tbody",null,n.length?i.a.createElement(E.a,{component:null},n.map((function(e){return i.a.createElement(j.a,{key:e.id,timeout:500,classNames:"fade"},i.a.createElement(O,{key:e.id,name:e.attributes.title,nodeId:e.attributes.drupal_internal__nid,updateItem:r,drupalId:e.id,listId:a}))}))):i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"2"},"No bios with this status.")))))}k.defaultProps={bios:[]};var _=k;function w(){var e=Object(g.a)(["\n  flex: 1 1 30%;\n  border: 1px solid grey;\n  margin: 0.5rem;\n  padding: 1rem;\n  border-radius: 10px;\n  display: flex;\n  & div {\n    flex: 1;\n    padding: 1em;\n  }\n  & div.field--name-body {\n    flex: 2;\n  }\n  & h3 {\n    margin-top: 0;\n  }\n  & img.match-image-style {\n    width: 100px;\n  }\n"]);return w=function(){return e},e}var P=y.a.article(w());var A=function(e){var t=e.name,a=e.nodeId,n=e.updateItem,r=e.drupalId,s=e.summary,o=e.headshotAlt,l=e.headshotFilename;return i.a.createElement(P,null,i.a.createElement("div",{className:"field field--name-field-headshot field--type-image field__item"},i.a.createElement("img",{src:"/sites/default/files/styles/thumbnail/public/headshots/".concat(l),alt:o})),i.a.createElement("div",{className:"clearfix text-formatted field field--name-body field--type-text-with-summary field__item"},i.a.createElement("h3",null,i.a.createElement("a",{href:"/node/".concat(a)},t),"\xa0",i.a.createElement("a",{href:"/node/".concat(a,"/edit")},"(Edit)")),i.a.createElement("p",null,s),i.a.createElement("button",{type:"button",onClick:function(){n(r,"inProgress","todo","To Do")}},"Move -> To Do")))};function T(){var e=Object(g.a)(["\n  display: flex;\n  flex-wrap: wrap;\n"]);return T=function(){return e},e}function S(){var e=Object(g.a)(["\n  margin-top: 3em;\n  //When element enters dom */\n  .fade-enter {\n    opacity: 0;\n  }\n  /* After element enters [transition time] */\n  .fade-enter-active {\n    opacity: 1;\n    transition: opacity 500ms ease-in;\n  }\n  /* When state turns false */\n  .fade-exit {\n    opacity: 1;\n  }\n  /* Right after exit [transition time] */\n  .fade-exit-active {\n    opacity: 0;\n    transition: opacity 500ms ease-in;\n  }\n"]);return S=function(){return e},e}var B=y.a.div(S()),C=y.a.div(T());function D(e){var t=e.title,a=e.bios,n=e.updateItem,r=e.included;return i.a.createElement(B,null,i.a.createElement("h2",null,t," ",i.a.createElement("span",null,a.length?"(".concat(a.length," item").concat(a.length>1?"s":"",")"):null)),i.a.createElement(C,null,a.length?i.a.createElement(E.a,{component:null},a.map((function(e){var t=r.find((function(t){return t.id===e.relationships.field_headshot.data.id})).attributes.filename;return i.a.createElement(j.a,{key:e.id,timeout:500,classNames:"fade"},i.a.createElement(A,{key:e.id,summary:e.attributes.body.summary,name:e.attributes.title,nodeId:e.attributes.drupal_internal__nid,updateItem:n,drupalId:e.id,headshotId:e.relationships.field_headshot.data.id,headshotAlt:e.relationships.field_headshot.data.meta.alt,headshotFilename:t}))}))):i.a.createElement("div",null,"Ready for bios!")))}D.defaultProps={bios:[]};var N=D;function W(){var e=Object(g.a)(["\n  position: relative;\n  padding: .75rem 1.25rem;\n  margin-bottom: 1rem;\n  border: 1px solid transparent;\n  border-radius: .25rem;\n\n  &.alert-danger {\n    color: #721c24;\n    background-color: #f8d7da;\n    border-color: #f5c6cb;\n  }\n"]);return W=function(){return e},e}var R=y.a.div(W());var F=function(e){var t=e.message,a=e.type;return i.a.createElement(R,{className:"alert-".concat(a),role:"alert"},t)};var G=function(e){Object(f.a)(a,e);var t=Object(v.a)(a);function a(){var e;return Object(h.a)(this,a),(e=t.call(this)).state={alert:"",bioData:[],bioIncluded:[],lists:{inProgress:{id:"inProgress",title:"In Progress"},todo:{id:"todo",title:"To Do"},done:{id:"done",title:"Done"}}},e.setBios=e.setBios.bind(Object(b.a)(e)),e.updateItem=e.updateItem.bind(Object(b.a)(e)),e.patchBio=e.patchBio.bind(Object(b.a)(e)),e.slowChangeAlert=e.slowChangeAlert.bind(Object(b.a)(e)),e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.setBios()}},{key:"setBios",value:function(){var e=Object(m.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/alittlebithidden/437/jsonapi/node/bio?include=field_headshot",e.prev=1,e.next=4,fetch("/alittlebithidden/437/jsonapi/node/bio?include=field_headshot",{method:"GET",credentials:"include",headers:{"Content-Type":"application/vnd.api+json"}});case 4:if((t=e.sent).ok){e.next=8;break}throw this.setState(Object(u.a)(Object(u.a)({},this.state),{},{alert:"Server bios are not available."})),Error(t.statusText);case 8:return e.next=10,t.json();case 10:a=e.sent,null!==(n=a)&&void 0!==n.data&&null!==n.data&&0!==n.data.length?this.setState({bioData:a.data,bioIncluded:a.included,lists:{inProgress:Object(u.a)(Object(u.a)({},this.state.lists.inProgress),{},{bios:a.data.filter((function(e){return"In Progress"===e.attributes.field_2020_migration_status}))}),todo:Object(u.a)(Object(u.a)({},this.state.lists.todo),{},{bios:a.data.filter((function(e){return"To Do"===e.attributes.field_2020_migration_status}))}),done:Object(u.a)(Object(u.a)({},this.state.lists.done),{},{bios:a.data.filter((function(e){return"Done"===e.attributes.field_2020_migration_status}))})}}):console.log("Bio data is not valid"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log("Initial GET API error",e.t0);case 17:case"end":return e.stop()}var n}),e,this,[[1,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"patchBio",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,i,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/session/token?_format=json",n="/alittlebithidden/437/jsonapi/node/bio/".concat(t),e.prev=2,e.next=5,fetch("/session/token?_format=json",{method:"GET",headers:{Accept:"application/vnd.api+json"}});case 5:if((i=e.sent).ok){e.next=9;break}throw this.setState(Object(u.a)(Object(u.a)({},this.state),{},{alert:"Server token not found."})),Error(i.statusText);case 9:return e.next=11,i.text();case 11:return r=e.sent,e.prev=12,e.next=15,fetch(n,{method:"PATCH",credentials:"same-origin",headers:{Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json","X-CSRF-Token":r},body:JSON.stringify({data:{type:"node--bio",id:t,attributes:{field_2020_migration_status:a}}})});case 15:if((s=e.sent).ok){e.next=19;break}throw this.setState(Object(u.a)(Object(u.a)({},this.state),{},{alert:"Server node cannot be updated."})),Error(s.statusText);case 19:return e.next=21,s.json();case 21:return e.abrupt("return",e.sent);case 24:e.prev=24,e.t0=e.catch(12),console.log("API Patch error",e.t0);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(2),console.log("API Token error",e.t1);case 32:return e.abrupt("return",!1);case 33:case"end":return e.stop()}}),e,this,[[2,29],[12,24]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"updateItem",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n,i){var r,s,c,m;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.patchBio(t,i);case 2:e.sent&&(s=this.state.bioData,(c=s.find((function(e){return e.id===t}))).attributes.field_2020_migration_status=i,m=this.state.lists[a].bios.filter((function(e){return e.id!==t})),this.setState(Object(u.a)(Object(u.a)({},this.state),{},{bioData:s,lists:Object(u.a)(Object(u.a)({},this.state.lists),{},(r={},Object(o.a)(r,a,Object(u.a)(Object(u.a)({},this.state.lists[a]),{},{bios:m})),Object(o.a)(r,n,Object(u.a)(Object(u.a)({},this.state.lists[n]),{},{bios:[].concat(Object(l.a)(this.state.lists[n].bios),[c])})),r))})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,a,n,i){return e.apply(this,arguments)}}()},{key:"slowChangeAlert",value:function(){var e=this;return this.state.alert.length>0&&(setTimeout((function(){e.setState(Object(u.a)(Object(u.a)({},e.state),{},{alert:""}))}),5e3),i.a.createElement(F,{message:this.state.alert,type:"danger"}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},this.slowChangeAlert(),["inProgress","todo","done"].map((function(t){var a=e.state.lists[t];return"inProgress"===t?i.a.createElement(N,{key:a.id,title:a.title,bios:a.bios,updateItem:e.updateItem,included:e.state.bioIncluded}):i.a.createElement(_,{key:a.id,title:a.title,listId:a.id,bios:a.bios,updateItem:e.updateItem})})))}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(G,null),document.getElementById("react-app")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);